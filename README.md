# 交互式三元结构多重分形系统浏览器 (RX-3) - 用户手册

**版本: 3.3.1**

## 1. 系统简介

“交互式三元结构多重分形系统浏览器 (RX-3)”是一款基于Web的动态可视化工具，它扩展了传统的二元（有效/无效）系统模型，引入了**三元结构（A类-创造, B类-结构, C类-消耗）**的思想来探索复杂层级系统。

本系统允许用户模拟和理解基于**二八定律（帕累托法则）**、**幂律分布**和**多重分形**原理构建的系统，但其核心分裂机制是三元的。每个节点在不同尺度下会分化为具有不同属性倾向的A、B、C三类子节点。这些子节点的体积比例和效应/成本贡献可以根据用户定义的参数动态调整，从而模拟出更为丰富和贴近现实（如生态、经济、社会系统）的复杂动态。

用户可以通过图形用户界面（GUI）调整系统生成参数，选择不同的可视化方式（旭日图、矩形树图），观察系统对参数变化的响应（演化），并与图表交互以查看特定节点的详细信息及其在三元结构中的贡献。

**核心特性：**

*   **三元分裂模型**：节点分化为A（创造）、B（结构/维持）、C（消耗/惰性）三类。
*   **参数化生成**：灵活控制三类节点的体积比例和效应/成本密度。
*   **动态密度调整**：A类节点的效应密度可随深度动态变化，初步体现多重分形特性。
*   **动态演化**：观察参数扰动对系统的影响。
*   **多种可视化**：旭日图和矩形树图，按体积或“净效应（可视化值）”展示。
*   **交互式探索**：点击节点查看详细属性（包括A效应、B成本、C成本、净效应）和子节点。
*   **实时反馈**：滑块调整参数时，其值实时显示。

## 2. 系统界面概览

系统界面主要分为两部分：

*   **左侧：控制面板** - 用于调整系统生成参数、选择可视化类型和控制系统行为。
*   **右侧：显示区域** - 用于展示生成系统的可视化图表、系统摘要统计以及被点击节点的详细信息。

(https://github.com/SAY683/RX-0/blob/main/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-05-19%20134646.png)

### 2.1 控制面板

控制面板包含以下主要控件：

*   **系统参数 (三元结构) 标题**
    *   **最大深度 (Max Depth)**:
        *   **功能**: 控制分形递归的最大层数。
        *   **提示**: 深度超过3-4（三元分裂下节点数为3^深度）时，性能可能急剧下降。
    *   **A类基础体积比例 (%) (`p_A_base`)**:
        *   **功能**: A类（创造）节点的基础体积占比。
    *   **B类基础体积比例 (%) (`p_B_base`)**:
        *   **功能**: B类（结构）节点的基础体积占比。
        *   **注意**: C类体积比例由 (100% - A类% - B类%) 间接确定，并会进行归一化。
    *   **A类基础效应密度 (`density_A_effect_base`)**:
        *   **功能**: A类节点的基础效应密度（每个单位体积产生的正效应量）。
    *   **A类密度深度影响因子 (`depth_density_A_factor`)**:
        *   **功能**: 每层深度，A类效应密度的变化量（乘以预设的敏感度因子）。负值表示随深度密度降低。
    *   **B类成本密度 (`density_B_cost`)**:
        *   **功能**: B类节点的维持成本密度（每个单位体积产生的成本）。
    *   **C类成本密度 (`density_C_cost`)**:
        *   **功能**: C类节点的消耗成本密度（每个单位体积产生的成本）。
    *   **A类体积深度影响因子 (`depth_vol_factor_A`)**:
        *   **功能**: 每层深度，A类体积比例的变化量（乘以预设的敏感度因子）。
    *   **B类体积深度影响因子 (`depth_vol_factor_B`)**:
        *   **功能**: 每层深度，B类体积比例的变化量（乘以预设的敏感度因子）。
    *   **随机性因子 (%) (`rand_factor`)**:
        *   **功能**: 为比例和密度计算增加随机扰动的最大幅度（相对于当前值的百分比）。
    *   **演化扰动幅度 (%) (`evolve_perturb_factor`)**:
        *   **功能**: 点击“演化系统”时，各参数（除自身外）随机变化的最大百分比（相对于参数自身的可调范围）。
*   **可视化类型**:
    *   **选项**:
        *   旭日图 (按体积)
        *   旭日图 (按净效应(可视化值))
        *   矩形树图 (按体积)
        *   矩形树图 (按净效应(可视化值))
    *   **功能**: 选择展示方式。当选择“按净效应(可视化值)”时，图表扇区大小代表一个经过调整的正值（确保父子和关系），用于可视化，而实际的净效应（可能为负）在悬停文本中显示。
*   **控制按钮**:
    *   **重新生成**: 使用当前参数重新生成系统。
    *   **演化系统**: 对参数进行随机扰动并重新生成。时间步加1。
    *   **重置演化**: 参数和时间步恢复到初始默认值并重新生成。
*   **时间步显示**: 显示当前演化步数。

### 2.2 显示区域

*   **可视化图表 (`fractal-viz`)**:
    *   **功能**: 展示系统结构。
    *   **交互**:
        *   **悬停 (Hover)**: 显示节点简要信息（类型、深度、体积、A效应、B成本、C成本、净效应）。
        *   **点击 (Click)**: 在下方“节点详情区域”显示该节点的详细信息。
*   **系统摘要与节点详情容器**:
    *   **系统摘要 (`summary-stats`)**:
        *   **功能**: 显示关键统计数据（总节点数、生成耗时、根节点体积、根节点各项效应/成本及净效应）。
    *   **节点详情区域 (`node-details-output`)**:
        *   **功能**: 显示被点击节点的详细信息：ID、标签、类型、深度、体积、该节点及其子树汇总的A效应/B成本/C成本/净效应，以及其直系子节点列表。

## 3. 使用方法

1.  **启动**: 运行Python脚本，在浏览器中打开给出的本地服务器地址。
2.  **调整参数**: 使用控制面板的滑块调整各项参数。
3.  **选择可视化**: 从下拉菜单选择图表类型和依据属性。
4.  **生成/演化**: 使用按钮控制系统的生成和演化。
5.  **探索图表**: 通过悬停、点击和图表本身的钻取功能（如果支持）来探索系统。

## 4. 核心算法概念 (三元模型)

*   **递归三元分裂**: 每个父节点根据规则分裂为A、B、C三个子节点，直至达到“最大深度”。
*   **参数化比例与密度**:
    *   **体积比例 (`p_A_base`, `p_B_base`, 深度影响因子)**: 控制A、B、C子节点继承父节点“体积”的百分比，可随深度动态调整。
    *   **效应/成本密度 (`density_A_effect_base`, `density_B_cost`, `density_C_cost`, A类密度深度影响因子)**:
        *   A类节点根据其（可动态调整的）效应密度和体积产生**正效应**。
        *   B类和C类节点根据其（当前为固定的）成本密度和体积产生**成本**（视为负效应）。
*   **净效应计算**: 每个节点的净效应是其（及其子树）总A效应减去总B成本和总C成本。
*   **可视化值 (`vis_values_net_effect`)**: 为了在图表中正确显示扇区大小（尤其是当净效应为负或父子和不一致时），系统会计算一个专门用于可视化的正值列表。该值确保了父节点的“可视化大小”等于其所有子节点“可视化大小”之和。
*   **多重分形特性 (初步体现)**: A类效应密度和三类体积比例随深度的变化引入了多尺度变异性。
*   **随机性**: 为比例和密度计算增加扰动。

## 5. 技术实现

*   **后端/逻辑**: Python
*   **Web框架**: Dash (by Plotly)
*   **可视化库**: Plotly
*   **数据处理**: NumPy

## 6. 注意事项与已知限制

*   **性能**: 三元分裂导致节点数以 3^深度 增长，请谨慎设置高深度。
*   **效应模型简化**: 当前B类和C类的成本密度是全局固定的。B类的角色主要体现为成本，更复杂的调节或转化功能未实现。
*   **可视化净效应**: “按净效应(可视化值)”视图中扇区大小是一个派生值，原始净效应（可正可负）需查看悬停文本或节点详情。
*   **`INITIAL_SYSTEM_NET_EFFECT`**: 此参数在当前自底向上汇总效应的模型中未起约束作用，已被移除。

## 7. 未来展望

*   **深化B类角色**: 赋予B类节点更复杂的调节、缓冲或转化功能。
*   **完全多重分形**: 让B、C类的成本密度也随深度/父类型动态调整。
*   **参数配置的保存/加载**。
*   **更高级的演化和优化算法**。
